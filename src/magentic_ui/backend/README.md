This code has been adapted from AutoGen Studio https://github.com/microsoft/autogen/tree/main/python/packages/autogen-studio